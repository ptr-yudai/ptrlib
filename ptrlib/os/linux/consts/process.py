"""Linux process-related constants.

Examples:
    from ptrlib.os.linux import consts
    consts.CLONE_NEWUSER
    consts.RLIMIT_NOFILE
"""

# waitpid/waitid options
WNOHANG = 0x00000001
WUNTRACED = 0x00000002
WSTOPPED = 0x00000002
WEXITED = 0x00000004
WCONTINUED = 0x00000008
WNOWAIT = 0x01000000
__WNOTHREAD = 0x20000000
__WALL = 0x40000000
__WCLONE = 0x80000000

P_ALL = 0
P_PID = 1
P_PGID = 2
P_PIDFD = 3

# clone/unshare flags
CSIGNAL = 0x000000ff
CLONE_VM = 0x00000100
CLONE_FS = 0x00000200
CLONE_FILES = 0x00000400
CLONE_SIGHAND = 0x00000800
CLONE_PIDFD = 0x00001000
CLONE_PTRACE = 0x00002000
CLONE_VFORK = 0x00004000
CLONE_PARENT = 0x00008000
CLONE_THREAD = 0x00010000
CLONE_NEWNS = 0x00020000
CLONE_SYSVSEM = 0x00040000
CLONE_SETTLS = 0x00080000
CLONE_PARENT_SETTID = 0x00100000
CLONE_CHILD_CLEARTID = 0x00200000
CLONE_DETACHED = 0x00400000
CLONE_UNTRACED = 0x00800000
CLONE_CHILD_SETTID = 0x01000000
CLONE_NEWCGROUP = 0x02000000
CLONE_NEWUTS = 0x04000000
CLONE_NEWIPC = 0x08000000
CLONE_NEWUSER = 0x10000000
CLONE_NEWPID = 0x20000000
CLONE_NEWNET = 0x40000000
CLONE_IO = 0x80000000
CLONE_CLEAR_SIGHAND = 0x100000000
CLONE_INTO_CGROUP = 0x200000000
CLONE_NEWTIME = 0x00000080

CLONE_ARGS_SIZE_VER0 = 64
CLONE_ARGS_SIZE_VER1 = 80
CLONE_ARGS_SIZE_VER2 = 88

# scheduling policies and flags
SCHED_NORMAL = 0
SCHED_FIFO = 1
SCHED_RR = 2
SCHED_BATCH = 3
SCHED_IDLE = 5
SCHED_DEADLINE = 6
SCHED_RESET_ON_FORK = 0x40000000

SCHED_FLAG_RESET_ON_FORK = 0x01
SCHED_FLAG_RECLAIM = 0x02
SCHED_FLAG_DL_OVERRUN = 0x04
SCHED_FLAG_KEEP_POLICY = 0x08
SCHED_FLAG_KEEP_PARAMS = 0x10
SCHED_FLAG_UTIL_CLAMP_MIN = 0x20
SCHED_FLAG_UTIL_CLAMP_MAX = 0x40
SCHED_FLAG_KEEP_ALL = 0x18
SCHED_FLAG_UTIL_CLAMP = 0x60
SCHED_FLAG_ALL = 0x7f

# resource limits and priorities
RLIMIT_CPU = 0
RLIMIT_FSIZE = 1
RLIMIT_DATA = 2
RLIMIT_STACK = 3
RLIMIT_CORE = 4
RLIMIT_RSS = 5
RLIMIT_NPROC = 6
RLIMIT_NOFILE = 7
RLIMIT_MEMLOCK = 8
RLIMIT_AS = 9
RLIMIT_LOCKS = 10
RLIMIT_SIGPENDING = 11
RLIMIT_MSGQUEUE = 12
RLIMIT_NICE = 13
RLIMIT_RTPRIO = 14
RLIMIT_RTTIME = 15
RLIM_NLIMITS = 16
RLIMIT_NLIMITS = 16

PRIO_MIN = -20
PRIO_MAX = 20
PRIO_PROCESS = 0
PRIO_PGRP = 1
PRIO_USER = 2

RUSAGE_SELF = 0
RUSAGE_CHILDREN = -1
RUSAGE_THREAD = 1

# prctl(2) options and sub-flags
PR_SET_PDEATHSIG = 1
PR_GET_PDEATHSIG = 2
PR_GET_DUMPABLE = 3
PR_SET_DUMPABLE = 4
PR_GET_UNALIGN = 5
PR_SET_UNALIGN = 6
PR_UNALIGN_NOPRINT = 1
PR_UNALIGN_SIGBUS = 2
PR_GET_KEEPCAPS = 7
PR_SET_KEEPCAPS = 8
PR_GET_FPEMU = 9
PR_SET_FPEMU = 10
PR_FPEMU_NOPRINT = 1
PR_FPEMU_SIGFPE = 2
PR_GET_FPEXC = 11
PR_SET_FPEXC = 12
PR_FP_EXC_SW_ENABLE = 0x80
PR_FP_EXC_DIV = 0x010000
PR_FP_EXC_OVF = 0x020000
PR_FP_EXC_UND = 0x040000
PR_FP_EXC_RES = 0x080000
PR_FP_EXC_INV = 0x100000
PR_FP_EXC_DISABLED = 0
PR_FP_EXC_NONRECOV = 1
PR_FP_EXC_ASYNC = 2
PR_FP_EXC_PRECISE = 3
PR_GET_TIMING = 13
PR_SET_TIMING = 14
PR_TIMING_STATISTICAL = 0
PR_TIMING_TIMESTAMP = 1
PR_SET_NAME = 15
PR_GET_NAME = 16
PR_GET_ENDIAN = 19
PR_SET_ENDIAN = 20
PR_ENDIAN_BIG = 0
PR_ENDIAN_LITTLE = 1
PR_ENDIAN_PPC_LITTLE = 2
PR_GET_SECCOMP = 21
PR_SET_SECCOMP = 22
PR_CAPBSET_READ = 23
PR_CAPBSET_DROP = 24
PR_GET_TSC = 25
PR_SET_TSC = 26
PR_TSC_ENABLE = 1
PR_TSC_SIGSEGV = 2
PR_GET_SECUREBITS = 27
PR_SET_SECUREBITS = 28
PR_SET_TIMERSLACK = 29
PR_GET_TIMERSLACK = 30
PR_TASK_PERF_EVENTS_DISABLE = 31
PR_TASK_PERF_EVENTS_ENABLE = 32
PR_MCE_KILL = 33
PR_MCE_KILL_CLEAR = 0
PR_MCE_KILL_SET = 1
PR_MCE_KILL_LATE = 0
PR_MCE_KILL_EARLY = 1
PR_MCE_KILL_DEFAULT = 2
PR_MCE_KILL_GET = 34
PR_SET_MM = 35
PR_SET_MM_START_CODE = 1
PR_SET_MM_END_CODE = 2
PR_SET_MM_START_DATA = 3
PR_SET_MM_END_DATA = 4
PR_SET_MM_START_STACK = 5
PR_SET_MM_START_BRK = 6
PR_SET_MM_BRK = 7
PR_SET_MM_ARG_START = 8
PR_SET_MM_ARG_END = 9
PR_SET_MM_ENV_START = 10
PR_SET_MM_ENV_END = 11
PR_SET_MM_AUXV = 12
PR_SET_MM_EXE_FILE = 13
PR_SET_MM_MAP = 14
PR_SET_MM_MAP_SIZE = 15
PR_SET_PTRACER = 0x59616d61
PR_SET_PTRACER_ANY = -1
PR_SET_CHILD_SUBREAPER = 36
PR_GET_CHILD_SUBREAPER = 37
PR_SET_NO_NEW_PRIVS = 38
PR_GET_NO_NEW_PRIVS = 39
PR_GET_TID_ADDRESS = 40
PR_SET_THP_DISABLE = 41
PR_GET_THP_DISABLE = 42
PR_MPX_ENABLE_MANAGEMENT = 43
PR_MPX_DISABLE_MANAGEMENT = 44
PR_SET_FP_MODE = 45
PR_GET_FP_MODE = 46
PR_FP_MODE_FR = 0x1
PR_FP_MODE_FRE = 0x2
PR_CAP_AMBIENT = 47
PR_CAP_AMBIENT_IS_SET = 1
PR_CAP_AMBIENT_RAISE = 2
PR_CAP_AMBIENT_LOWER = 3
PR_CAP_AMBIENT_CLEAR_ALL = 4
PR_SVE_SET_VL = 50
PR_SVE_SET_VL_ONEXEC = 0x40000
PR_SVE_GET_VL = 51
PR_SVE_VL_LEN_MASK = 0xffff
PR_SVE_VL_INHERIT = 0x20000
PR_GET_SPECULATION_CTRL = 52
PR_SET_SPECULATION_CTRL = 53
PR_SPEC_STORE_BYPASS = 0
PR_SPEC_INDIRECT_BRANCH = 1
PR_SPEC_L1D_FLUSH = 2
PR_SPEC_NOT_AFFECTED = 0
PR_SPEC_PRCTL = 0x1
PR_SPEC_ENABLE = 0x2
PR_SPEC_DISABLE = 0x4
PR_SPEC_FORCE_DISABLE = 0x8
PR_SPEC_DISABLE_NOEXEC = 0x10
PR_PAC_RESET_KEYS = 54
PR_PAC_APIAKEY = 0x1
PR_PAC_APIBKEY = 0x2
PR_PAC_APDAKEY = 0x4
PR_PAC_APDBKEY = 0x8
PR_PAC_APGAKEY = 0x10
PR_SET_TAGGED_ADDR_CTRL = 55
PR_GET_TAGGED_ADDR_CTRL = 56
PR_TAGGED_ADDR_ENABLE = 0x1
PR_MTE_TCF_NONE = 0x0
PR_MTE_TCF_SYNC = 0x2
PR_MTE_TCF_ASYNC = 0x4
PR_MTE_TCF_MASK = 0x6
PR_MTE_TAG_SHIFT = 3
PR_MTE_TAG_MASK = 0x7fff8
PR_MTE_TCF_SHIFT = 1
PR_SET_IO_FLUSHER = 57
PR_GET_IO_FLUSHER = 58
PR_SET_SYSCALL_USER_DISPATCH = 59
PR_SYS_DISPATCH_OFF = 0
PR_SYS_DISPATCH_ON = 1
PR_PAC_SET_ENABLED_KEYS = 60
PR_PAC_GET_ENABLED_KEYS = 61
PR_SCHED_CORE = 62
PR_SCHED_CORE_GET = 0
PR_SCHED_CORE_CREATE = 1
PR_SCHED_CORE_SHARE_TO = 2
PR_SCHED_CORE_SHARE_FROM = 3
PR_SCHED_CORE_MAX = 4
PR_SCHED_CORE_SCOPE_THREAD = 0
PR_SCHED_CORE_SCOPE_THREAD_GROUP = 1
PR_SCHED_CORE_SCOPE_PROCESS_GROUP = 2
PR_SME_SET_VL = 63
PR_SME_SET_VL_ONEXEC = 0x40000
PR_SME_GET_VL = 64
PR_SME_VL_LEN_MASK = 0xffff
PR_SME_VL_INHERIT = 0x20000
PR_SET_MDWE = 65
PR_MDWE_REFUSE_EXEC_GAIN = 0x1
PR_MDWE_NO_INHERIT = 0x2
PR_GET_MDWE = 66
PR_SET_VMA = 0x53564d41
PR_SET_VMA_ANON_NAME = 0
PR_GET_AUXV = 0x41555856
PR_SET_MEMORY_MERGE = 67
PR_GET_MEMORY_MERGE = 68
PR_RISCV_V_SET_CONTROL = 69
PR_RISCV_V_GET_CONTROL = 70
PR_RISCV_V_VSTATE_CTRL_DEFAULT = 0
PR_RISCV_V_VSTATE_CTRL_OFF = 1
PR_RISCV_V_VSTATE_CTRL_ON = 2
PR_RISCV_V_VSTATE_CTRL_INHERIT = 0x10
PR_RISCV_V_VSTATE_CTRL_CUR_MASK = 0x3
PR_RISCV_V_VSTATE_CTRL_NEXT_MASK = 0xc
PR_RISCV_V_VSTATE_CTRL_MASK = 0x1f

__all__ = [name for name in globals() if name.isupper()]
